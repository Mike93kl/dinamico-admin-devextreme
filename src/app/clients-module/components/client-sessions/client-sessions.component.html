<h5 class="text-center">Sessions</h5>
<hr>

<div class="top-action-button">
  <a routerLink="/appointments/new" class="text-primary mx-2" data-toggle="tooltip" data-placement="top"
     title="Create new Session Day">
    <i class="far fa-calendar-plus" style="font-size: 2em; cursor: pointer"></i>
  </a>

  <app-session-types-v1 [showDumbbellIcon]="true"
                        data-toggle="tooltip" data-placement="top"
                        title="View or create session types"
                        (onSessionTypesFetched)="onSessionTypesFetched($event)"
  ></app-session-types-v1>
</div>

<div class="sessions-view-option-wrapper">
  <h6>All Sessions: </h6>
  <div class="calendar-view-options">

    <div class="form-check">
      <input class="form-check-input" type="radio" name="calendarViewOptions" id="todayNAfter"
             [value]="false" [(ngModel)]="showDateRangeOfAllSessions" (click)="getAllSessionsAfterToday()">
      <label class="form-check-label" for="todayNAfter">
        Show today and after
      </label>
    </div>
    <div class="form-check">
      <input class="form-check-input" type="radio" name="calendarViewOptions" id="range"
             [value]="true" [(ngModel)]="showDateRangeOfAllSessions">
      <label class="form-check-label" for="range">
        Date range
      </label>
    </div>

  </div>


  <div class="dx-fieldset" *ngIf="!showDateRangeOfAllSessions">
    <div class="dx-field">
      <div class="dx-field-label">All sessions - showing <strong>{{allSessionLimit}}</strong> Results</div>
      <div class="dx-field-value">
        <dx-select-box (valueChange)="onLimitResultsChanged($event, 'all')"
                       [value]="allSessionLimit"
                       [items]="[100, 200, 400, 500]"></dx-select-box>
      </div>
    </div>
  </div>

  <div class="date-range-options" *ngIf="showDateRangeOfAllSessions">

    <dx-date-box class="my-3"
                 #dateStart
                 type="date">
    </dx-date-box>

    <dx-date-box class="my-3"
                 #dateEnd
                 type="date">
    </dx-date-box>

    <dx-button
      stylingMode="outlined"
      text="Go"
      type="normal"
      [width]="120"
      (onClick)="fetchAllSessionsByDateRange(dateStart.value, dateEnd.value)">
    </dx-button>

  </div>
</div>




<div class="sessions-view-option-wrapper">
  <h6>Client Sessions: </h6>
  <div class="calendar-view-options">

    <div class="form-check">
      <input class="form-check-input" type="radio" name="calendarViewOptions1" id="todayNAfter1"
             [value]="false" [(ngModel)]="showDateRangeOfClientSessions" (click)="getClientSessionsAfterToday()">
      <label class="form-check-label" for="todayNAfter1">
        Show today and after
      </label>
    </div>
    <div class="form-check">
      <input class="form-check-input" type="radio" name="calendarViewOptions1" id="range1"
             [value]="true" [(ngModel)]="showDateRangeOfClientSessions">
      <label class="form-check-label" for="range1">
        Date range
      </label>
    </div>

  </div>


  <div class="dx-fieldset" *ngIf="!showDateRangeOfClientSessions">
    <div class="dx-field">
      <div class="dx-field-label">Client sessions - showing <strong>{{clientSessionsLimit}}</strong> Results</div>
      <div class="dx-field-value">
        <dx-select-box (valueChange)="onLimitResultsChanged($event, 'client-sessions')"
                       [value]="clientSessionsLimit"
                       [items]="[100, 200, 400, 500]"></dx-select-box>
      </div>
    </div>
  </div>

  <div class="date-range-options" *ngIf="showDateRangeOfClientSessions">

    <dx-date-box class="my-3"
                 #dateStart
                 type="date">
    </dx-date-box>

    <dx-date-box class="my-3"
                 #dateEnd
                 type="date">
    </dx-date-box>

    <dx-button
      stylingMode="outlined"
      text="Go"
      type="normal"
      [width]="120"
      (onClick)="fetchClientSessionsByDateRange(dateStart.value, dateEnd.value)">
    </dx-button>

  </div>
</div>


<div class="sessions-view-option-wrapper">

  <div class="dx-fieldset" *ngIf="!showDateRangeOfClientSessions">
    <div class="dx-field">
      <div class="dx-field-label">Showing <strong>{{sessionStatus}}</strong> sessions</div>
      <div class="dx-field-value">
        <dx-select-box (valueChange)="onSessionStatusChanged($event)"
                       [value]="sessionStatus"
                       [items]="['attended', 'cancelled', 'upcoming', 'all']"></dx-select-box>
      </div>
    </div>
  </div>

</div>




<div class="dot-group">
  <div class="dot-info">
    <div class="dot passed"></div>
    <div>Passed session</div>
  </div>
  <div class="dot-info">
    <div class="dot open"></div>
    <div>Open session</div>
  </div>
  <div class="dot-info">
    <div class="dot full"></div>
    <div>Full session</div>
  </div>
  <div class="dot-info">
    <div class="dot client-session-dot"></div>
    <div>Client session</div>
  </div>
  <div class="dot-info">
    <div class="dot client-session-cancelled-dot"></div>
    <div>Cancelled session</div>
  </div>

  <div class="dot-info">
    <div class="dot passed-subscribed"></div>
    <div>Passed subscribed session</div>
  </div>
  <div class="dot-info">
    <div class="dot full-subscribed"></div>
    <div>Full subscribed session</div>
  </div>
</div>

<dx-scheduler
  id="scheduler"
  timeZone="Europe/Athens"
  [dataSource]="calendarItems"
  [views]='["month", "week", "day", "timelineDay"]'
  currentView="day"
  firstDayOfWeek="1"
  [currentDate]="currentDate"
  [startDayHour]="6"
  [endDayHour]="23"
  [height]="650"
  appointmentTemplate="appointment-template"
  (onAppointmentRendered)="onAppointmentRendered($event)"
  (onAppointmentFormOpening)="onAppointmentFormOpening($event)">
  <dxo-editing
    [allowAdding]="false"
    [allowDeleting]="false"
    [allowUpdating]="false"
    [allowResizing]="false"
    [allowDragging]="false"
  ></dxo-editing>

  <div *dxTemplate="let model of 'appointment-template'">
    <div class="session-preview">
      <p>{{model.appointmentData.text}}</p>
    </div>
    <!--    <div class='session-type-preview'-->
    <!--    >-->

    <!--      <div>{{model.appointmentData.text}} Session</div>-->
    <!--      <div>Subscribers-->
    <!--        <strong>{{model.appointmentData.subscriptions.length}} / {{ model.appointmentData.spots }}</strong>-->
    <!--      </div>-->
    <!--    </div>-->
  </div>

</dx-scheduler>

<!--Loader-->
<dx-load-panel
  shadingColor="rgba(0,0,0,0.4)"
  [position]="{ of: '#scheduler' }"
  [(visible)]="loadingVisible"
  [showIndicator]="true"
  [showPane]="true"
  [shading]="true"
  [closeOnOutsideClick]="false">
</dx-load-panel>


